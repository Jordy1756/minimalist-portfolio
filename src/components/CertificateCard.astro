---
import type { Certificate } from "@entities/certificate";
import ExternalIcon from "@icons/ExternalIcon.astro";
import { getFormattedDate } from "@utils/handleDates";
import { getLangFromUrl, useTranslations } from "@i18n/utils";

interface Props {
	certificate: Certificate;
}

const { certificate } = Astro.props;
const { name, date, issuer, url } = certificate;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const localeCode = lang === "es" ? "es-ES" : "en-US";
const formattedDate = getFormattedDate(date, localeCode, { month: "short" });
---

<article class="relative grid grid-cols-[auto_1fr] grid-rows-[auto_1fr] gap-x-4 gap-y-1 pl-2">
	<span class="absolute top-2/4 -left-4 h-2 w-2 -translate-y-2/4 rounded-full bg-neutral-200"
	></span>
	<aside class="row-span-2 flex items-center">
		<time
			class="text-xs font-normal text-nowrap text-neutral-500 uppercase"
			datetime={date + ""}
		>
			{formattedDate}
		</time>
	</aside>
	<header class="flex items-start justify-between gap-2">
		<h3 class="text-base font-semibold text-neutral-900">{name}</h3>
		<a
			class="text-sm underline"
			href={url}
			target="_blank"
			rel="noopener noreferrer"
			title={t("certificates.card.aria", name, issuer)}
			aria-label={t("certificates.card.aria", name, issuer)}
		>
			<ExternalIcon
				width={16}
				height={16}
				class="text-neutral-700 transition-colors hover:text-neutral-900"
			/>
		</a>
	</header>
	<section class="flex items-center justify-between gap-2">
		<p class="text-sm">{issuer}</p>
	</section>
</article>
